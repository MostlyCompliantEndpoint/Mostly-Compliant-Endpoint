<Page
    x:Class="AssignedAccessDesigner.Views.WizardStep2AppsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:vm="using:AssignedAccessDesigner.ViewModels">
    <Page.Resources>
        <DataTemplate x:Key="PickerItemTemplate" x:DataType="vm:AppxPackage">
            <StackPanel Orientation="Vertical">
                <TextBlock Text="{x:Bind DisplayName}" />
                <TextBlock Text="{x:Bind FullName}" Foreground="Gray" FontSize="12" />
                <TextBlock Text="{x:Bind PublisherDisplayName}" Foreground="Gray" FontSize="12" />
            </StackPanel>
        </DataTemplate>
    </Page.Resources>

    <Grid Padding="24">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        

        <!-- InfoBar for validation messages -->
        <InfoBar x:Name="ValidationInfoBar"
                 Title="Validation required"
                 Message="Please fix highlighted fields before continuing."
                 Severity="Error"
                 IsOpen="False"
                 Grid.Row="0"/>
        <StackPanel>
            <TextBlock Text="Allowed Apps" Style="{StaticResource TitleTextBlockStyle}" />
            <StackPanel Orientation="Horizontal" Grid.Row="1" HorizontalAlignment="Left" Spacing="8" Margin="0,12,0,12">
                <Button x:Name="AddUWP" Content="Add UWP" Click="AddUwpApps_Click" />
                <Button x:Name="AddExplorer" Content="Add From Explorer" Click="AddFromExplorer_Click" />
                <Button x:Name="AddButton" Content="Add Manually" Click="Add_Click"/>
                <Button x:Name="RemoveButton" Content="Remove selected" Click="Remove_Click"/>
            </StackPanel>
            <ListView x:Name="AppsList" Grid.Row="2" SelectionMode="Single" Visibility="Collapsed" HorizontalAlignment="Stretch" ScrollViewer.HorizontalScrollMode="Enabled" ScrollViewer.HorizontalScrollBarVisibility="Visible" ScrollViewer.VerticalScrollMode="Enabled" ScrollViewer.VerticalScrollBarVisibility="Visible">
                <ListView.ItemTemplate>
                    <DataTemplate x:DataType="models:AllowedApp" xmlns:models="using:AssignedAccessDesigner.Models" >
                        <StackPanel Orientation="Horizontal" Spacing="12" Margin="0,8,0,8" HorizontalAlignment="Stretch" >
                            <CheckBox x:Name="AutoLaunchCB" Checked="autoLaunchFocus" Unchecked="autoLaunchFocus" IsChecked="{x:Bind AutoLaunch, Mode=TwoWay}" Content="AutoLaunch"/>
            
                            <ComboBox x:Name="ProfileCombobox" ItemsSource="{x:Bind ProfileListIds}"  Header="Profile ID" SelectedValue="{x:Bind ProfileId, Mode=TwoWay}"/>
                            <TextBox Header="AUMID or Path"
                                            Text="{x:Bind AppPath, Mode=TwoWay}" 
                                            LostFocus="Path_LostFocus"
                                            MinWidth="500"
                                            />
                            <TextBox x:Name="AutoLaunchArgsTextbox" Header="Autolaunch Arguments"
                                            Text="{x:Bind AutoLaunchArgs, Mode=TwoWay}" 
                                            MinWidth="300"
                                            />

                        </StackPanel>

                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>

            <ListView x:Name="SingleAppsList" Grid.Row="2" Visibility="Collapsed" SelectionMode="Single" HorizontalAlignment="Stretch" ScrollViewer.HorizontalScrollMode="Enabled" ScrollViewer.HorizontalScrollBarVisibility="Visible" ScrollViewer.VerticalScrollMode="Enabled" ScrollViewer.VerticalScrollBarVisibility="Visible">
                <ListView.ItemTemplate>
                    <DataTemplate x:DataType="models:SingleApp" xmlns:models="using:AssignedAccessDesigner.Models" >
                        <StackPanel Orientation="Horizontal" Spacing="12" Margin="0,8,0,8" HorizontalAlignment="Stretch" >
                            <NumberBox x:Name="SingleAppProfileId" IsEnabled="False" Header="Profile ID:" Value="{x:Bind ProfileId, Mode=TwoWay}"/>
                            <TextBox x:Name="SingleAppPath" MinWidth="500" Header="AUMID or Path" Text="{x:Bind AppPath, Mode=TwoWay}" LostFocus="SinglePath_LostFocus"></TextBox>
                            <TextBox x:Name="SingleAppArgs" Header="Launch Arguments" Text="{x:Bind AppArguments, Mode=TwoWay}"></TextBox>
                            <TextBox x:Name="BreakoutSequence" Header="Breakout Sequence" Text="{x:Bind BreakoutSequence, Mode=TwoWay}"></TextBox>
                        </StackPanel>

                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>
        </StackPanel>


    </Grid>
</Page>